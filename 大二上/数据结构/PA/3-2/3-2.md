## PA3-2 Hacker

### 一、算法分析

主要考虑暴力破解法。

对于每个属于 $D_i$ 的字符串，考虑维护其 $hash$ 值，以此为键，通过散列加链表的方式存储 $hash$ 值、字符串序列以及 $hash$ 值是否存在重复。

那么每次询问只须考虑在散列中寻找是否存在对应的 $hash$ 值并且是否重复即可。

对于初始的 $D_1$，考虑用递归的方法枚举：

- 从 $1$ 到 $5$ 枚举长度，并设置为递归长度上限开始递归。
- 如果当前长度已经达到上限，则对于当前得到的字符串进行 $hash$ 计算以及加入散列。
- 否则给当前这一位赋值 `0123456789tsinghua` 中的每一个，并进入下一层递归。

这样可以容易得到枚举任意长度 $k$ 的字符串的方法。

对于每次询问结束后，只须根据之前的 $A_i$ 集合，在末尾添加一个首字母并去掉多余的串，更新为 $A_{i + 1}$，并加入到散列中即可。

### 二、复杂度分析

初始枚举部分复杂度为 $O\left(\sum\limits_{i = 1}^5 18^i \right) = O(18^5)$。

每次询问会进行 $O(k)$ 次散列查询和插入操作，并且会有 $O(k)$ 次复杂度为 $O(k)$ 的字符串移动拼接操作。

而总共产生的明文集合大小至多为：
$$
\sum_{i = 1}^5 18^i + 5 \times n \le 1.1 \times 10^7
$$
每次对字符串 $S$ 进行的 $CRC32$ 操作复杂度为 $O(|S| + |salt|) = O(12)$。

而散列采用的模数大约为 $10^7$ 级别，因此可认为平均每次的查询插入操作均为 $O(1)$。

综上所述，总体时间复杂度大约为 $O\left((|salt| + k)(|\mathrm{charset}|^5 + 5n) + kn + k^2\right)$，其中 $\mathrm{charset}$ 为字符集，$k$ 不超过 $8$，由于每次 $CRC32$ 的操作实际上常数极小，因此总体时间复杂度常数也较小。

而总体的空间复杂度为 $O\left(k(|\mathrm{charset}|^5 + 5n) + mod\right)$，其中 $mod$ 为散列算法所取的模数大小。

### 三、问题与解决

在散列判重时，不能根据 $hash$ 值重复即认为存在多个匹配明文，因为需要考虑到明文集合出现重复字符串的可能。

加盐求 $CRC32$ 的过程可以分为，先对字符串求 $CRC32$，再在得到的返回值基础上对 $salt$ 求 $CRC32$ 两步，可以有效减少字符串的拼接等繁杂操作。

